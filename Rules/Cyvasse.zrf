(define step (
  $1 (verify empty?) add
))

(define common-board
  (image "../images/Cyvasse/$1.bmp")
  (positions
             (a1 110   9 160  59)
             (a2  85  59 135 109)
             (a3  60 109 110 159)
             (a4  35 159  85 209)
             (a5  10 209  60 259)
             (a9 -90 409 -40 459)
             (b1 160   9 210  59)
             (b2 135  59 185 109)
             (b3 110 109 160 159)
             (b4  85 159 135 209)
             (b5  60 209 110 259)
             (b6  35 259  85 309)
             (c1 210   9 260  59)
             (c2 185  59 235 109)
             (c3 160 109 210 159)
             (c4 135 159 185 209)
             (c5 110 209 160 259)
             (c6  85 259 135 309)
             (c7  60 309 110 359)
             (d1 260   9 310  59)
             (d2 235  59 285 109)
             (d3 210 109 260 159)
             (d4 185 159 235 209)
             (d5 160 209 210 259)
             (d6 135 259 185 309)
             (d7 110 309 160 359)
             (d8  85 359 135 409)
             (e1 310   9 360  59)
             (e2 285  59 335 109)
             (e3 260 109 310 159)
             (e4 235 159 285 209)
             (e5 210 209 260 259)
             (e6 185 259 235 309)
             (e7 160 309 210 359)
             (e8 135 359 185 409)
             (e9 110 409 160 459)
             (f1 360   9 410  59)
             (f2 335  59 385 109)
             (f3 310 109 360 159)
             (f4 285 159 335 209)
             (f5 260 209 310 259)
             (f6 235 259 285 309)
             (f7 210 309 260 359)
             (f8 185 359 235 409)
             (f9 160 409 210 459)
             (g1 410   9 460  59)
             (g2 385  59 435 109)
             (g3 360 109 410 159)
             (g4 335 159 385 209)
             (g5 310 209 360 259)
             (g6 285 259 335 309)
             (g7 260 309 310 359)
             (g8 235 359 285 409)
             (g9 210 409 260 459)
             (h1 460   9 510  59)
             (h2 435  59 485 109)
             (h3 410 109 460 159)
             (h4 385 159 435 209)
             (h5 360 209 410 259)
             (h6 335 259 385 309)
             (h7 310 309 360 359)
             (h8 285 359 335 409)
             (h9 260 409 310 459)
             (i2 485  59 535 109)
             (i3 460 109 510 159)
             (i4 435 159 485 209)
             (i5 410 209 460 259)
             (i6 385 259 435 309)
             (i7 360 309 410 359)
             (i8 335 359 385 409)
             (i9 310 409 360 459)
             (j3 510 109 560 159)
             (j4 485 159 535 209)
             (j5 460 209 510 259)
             (j6 435 259 485 309)
             (j7 410 309 460 359)
             (j8 385 359 435 409)
             (j9 360 409 410 459)
             (k4 535 159 585 209)
             (k5 510 209 560 259)
             (k6 485 259 535 309)
             (k7 460 309 510 359)
             (k8 435 359 485 409)
             (k9 410 409 460 459)
             (l5 560 209 610 259)
             (l6 535 259 585 309)
             (l7 510 309 560 359)
             (l8 485 359 535 409)
             (l9 460 409 510 459)
   )
   (links w 
       (f9 e9) (g9 f9) (h9 g9) (i9 h9) (j9 i9) (k9 j9) (l9 k9) 
       (e8 d8) (f8 e8) (g8 f8) (h8 g8) (i8 h8) (j8 i8) (k8 j8) 
       (d7 c7) (e7 d7) (f7 e7) (g7 f7) (h7 g7) (i7 h7) (j7 i7) 
       (c6 b6) (d6 c6) (e6 d6) (f6 e6) (g6 f6) (h6 g6) (i6 h6) 
       (b5 a5) (c5 b5) (d5 c5) (e5 d5) (f5 e5) (g5 f5) (h5 g5) 
       (b4 a4) (c4 b4) (d4 c4) (e4 d4) (f4 e4) (g4 f4) (h4 g4) 
       (b3 a3) (c3 b3) (d3 c3) (e3 d3) (f3 e3) (g3 f3) (h3 g3) 
       (b2 a2) (c2 b2) (d2 c2) (e2 d2) (f2 e2) (g2 f2) (h2 g2)
       (b1 a1) (c1 b1) (d1 c1) (e1 d1) (f1 e1) (g1 f1) (h1 g1)
       (l8 k8) (k7 j7) (l7 k7) (j6 i6) (k6 j6) (l6 k6) (i5 h5)
       (j5 i5) (k5 j5) (l5 k5) (i4 h4) (j4 i4) (k4 j4) (i3 h3)
       (j3 i3) (i2 h2)
   )
   (links e 
       (e9 f9) (f9 g9) (g9 h9) (h9 i9) (i9 j9) (j9 k9) (k9 l9) 
       (d8 e8) (e8 f8) (f8 g8) (g8 h8) (h8 i8) (i8 j8) (j8 k8)
       (c7 d7) (d7 e7) (e7 f7) (f7 g7) (g7 h7) (h7 i7) (i7 j7)
       (b6 c6) (c6 d6) (d6 e6) (e6 f6) (f6 g6) (g6 h6) (h6 i6) 
       (a5 b5) (b5 c5) (c5 d5) (d5 e5) (e5 f5) (f5 g5) (g5 h5)
       (a4 b4) (b4 c4) (c4 d4) (d4 e4) (e4 f4) (f4 g4) (g4 h4)
       (a3 b3) (b3 c3) (c3 d3) (d3 e3) (e3 f3) (f3 g3) (g3 h3)
       (a2 b2) (b2 c2) (c2 d2) (d2 e2) (e2 f2) (f2 g2) (g2 h2)
       (a1 b1) (b1 c1) (c1 d1) (d1 e1) (e1 f1) (f1 g1) (g1 h1)
       (k8 l8) (j7 k7) (k7 l7) (i6 j6) (j6 k6) (k6 l6) (h5 i5)
       (i5 j5) (j5 k5) (k5 l5) (h4 i4) (i4 j4) (j4 k4) (h3 i3) 
       (i3 j3) (h2 i2)
   )
   (links nw 
       (e9 d8) (f9 e8) (g9 f8) (h9 g8) (i9 h8) (j9 i8) (k9 j8)
       (d8 c7) (e8 d7) (f8 e7) (g8 f7) (h8 g7) (i8 h7) (j8 i7)
       (c7 b6) (d7 c6) (e7 d6) (f7 e6) (g7 f6) (h7 g6) (i7 h6)
       (b6 a5) (c6 b5) (d6 c5) (e6 d5) (f6 e5) (g6 f5) (h6 g5)
       (b5 a4) (c5 b4) (d5 c4) (e5 d4) (f5 e4) (g5 f4) (h5 g4)
       (b4 a3) (c4 b3) (d4 c3) (e4 d3) (f4 e3) (g4 f3) (h4 g3)
       (b3 a2) (c3 b2) (d3 c2) (e3 d2) (f3 e2) (g3 f2) (h3 g2)
       (b2 a1) (c2 b1) (d2 c1) (e2 d1) (f2 e1) (g2 f1) (h2 g1)
       (l9 k8) (k8 j7) (l8 k7) (j7 i6) (k7 j6) (l7 k6) (i6 h5) 
       (j6 i5) (k6 j5) (l6 k5) (i5 h4) (j5 i4) (k5 j4) (l5 k4)
       (i4 h3) (j4 i3) (k4 j3) (i3 h2) (j3 i2) (i2 h1)
   )
   (links se 
       (d8 e9) (e8 f9) (f8 g9) (g8 h9) (h8 i9) (i8 j9) (j8 k9)
       (c7 d8) (d7 e8) (e7 f8) (f7 g8) (g7 h8) (h7 i8) (i7 j8)
       (b6 c7) (c6 d7) (d6 e7) (e6 f7) (f6 g7) (g6 h7) (h6 i7)
       (a5 b6) (b5 c6) (c5 d6) (d5 e6) (e5 f6) (f5 g6) (g5 h6)
       (a4 b5) (b4 c5) (c4 d5) (d4 e5) (e4 f5) (f4 g5) (g4 h5)
       (a3 b4) (b3 c4) (c3 d4) (d3 e4) (e3 f4) (f3 g4) (g3 h4)
       (a2 b3) (b2 c3) (c2 d3) (d2 e3) (e2 f3) (f2 g3) (g2 h3)
       (a1 b2) (b1 c2) (c1 d2) (d1 e2) (e1 f2) (f1 g2) (g1 h2)
       (k8 l9) (j7 k8) (k7 l8) (i6 j7) (j6 k7) (k6 l7) (h5 i6)
       (i5 j6) (j5 k6) (k5 l6) (h4 i5) (i4 j5) (j4 k5) (k4 l5)
       (h3 i4) (i3 j4) (j3 k4) (h2 i3) (i2 j3) (h1 i2)
   )
   (links ne 
       (e9 e8) (f9 f8) (g9 g8) (h9 h8) (i9 i8) (j9 j8) (k9 k8)
       (d8 d7) (e8 e7) (f8 f7) (g8 g7) (h8 h7) (i8 i7) (j8 j7)
       (c7 c6) (d7 d6) (e7 e6) (f7 f6) (g7 g6) (h7 h6) (i7 i6)
       (b6 b5) (c6 c5) (d6 d5) (e6 e5) (f6 f5) (g6 g5) (h6 h5)
       (a5 a4) (b5 b4) (c5 c4) (d5 d4) (e5 e4) (f5 f4) (g5 g4)
       (a4 a3) (b4 b3) (c4 c3) (d4 d3) (e4 e3) (f4 f3) (g4 g3)
       (a3 a2) (b3 b2) (c3 c2) (d3 d2) (e3 e2) (f3 f2) (g3 g2)
       (a2 a1) (b2 b1) (c2 c1) (d2 d1) (e2 e1) (f2 f1) (g2 g1)
       (l9 l8) (l8 l7) (k8 k7) (j7 j6) (k7 k6) (l7 l6) (i6 i5) 
       (j6 j5) (k6 k5) (l6 l5) (h5 h4) (i5 i4) (j5 j4) (k5 k4)
       (h4 h3) (i4 i3) (j4 j3) (h3 h2) (i3 i2) (h2 h1)
   )
   (links sw 
       (e8 e9) (f8 f9) (g8 g9) (h8 h9) (i8 i9) (j8 j9) (k8 k9)
       (d7 d8) (e7 e8) (f7 f8) (g7 g8) (h7 h8) (i7 i8) (j7 j8)
       (c6 c7) (d6 d7) (e6 e7) (f6 f7) (g6 g7) (h6 h7) (i6 i7)
       (b5 b6) (c5 c6) (d5 d6) (e5 e6) (f5 f6) (g5 g6) (h5 h6)
       (a4 a5) (b4 b5) (c4 c5) (d4 d5) (e4 e5) (f4 f5) (g4 g5)
       (a3 a4) (b3 b4) (c3 c4) (d3 d4) (e3 e4) (f3 f4) (g3 g4)
       (a2 a3) (b2 b3) (c2 c3) (d2 d3) (e2 e3) (f2 f3) (g2 g3)
       (a1 a2) (b1 b2) (c1 c2) (d1 d2) (e1 e2) (f1 f2) (g1 g2)
       (l8 l9) (k7 k8) (l7 l8) (j6 j7) (k6 k7) (l6 l7) (i5 i6) 
       (j5 j6) (k5 k6) (l5 l6) (h4 h5) (i4 i5) (j4 j5) (k4 k5)
       (h3 h4) (i3 i4) (j3 j4) (h2 h3) (i2 i3) (h1 h2)
   )
)

(game
   (title "Nine-Tile Cyvasse")

   (option "prevent flipping" true)
   (animate-captures false)

   (move-sound "Audio\Pickup.wav")
   (release-sound "Audio\Pickup.wav")
   (capture-sound "")
   (drop-sound "")

   (players White Black)
   (turn-order White Black)

   (board
      (common-board board)
      (zone (name water) (players White Black)
            (positions a9)
      )
   )

   (piece
      (name Mount)
      (image White "../images/Cyvasse/mount.bmp"
             Black "../images/Cyvasse/mount.bmp")
   )

   (piece
      (name King)
      (image White "../images/Cyvasse/wking.bmp"
             Black "../images/Cyvasse/bking.bmp")
      (moves
         (step nw) (step ne) (step sw) (step se) (step w) (step e)
      )
   )
   (piece
      (name Rabble)
      (image White "../images/Cyvasse/wrabble.bmp"
             Black "../images/Cyvasse/brabble.bmp")
      (moves
         (step nw) (step ne) (step sw) (step se) (step w) (step e)
      )
   )
   (piece
      (name Spears)
      (image White "../images/Cyvasse/wspears.bmp"
             Black "../images/Cyvasse/bspears.bmp")
      (moves
         (step nw) (step ne) (step sw) (step se) (step w) (step e)
      )
   )
   (piece
      (name LightHorse)
      (image White "../images/Cyvasse/wlighth.bmp"
             Black "../images/Cyvasse/blighth.bmp")
      (moves
         (step nw) (step ne) (step sw) (step se) (step w) (step e)
      )
   )
   (piece
      (name HeavyHorse)
      (image White "../images/Cyvasse/wheavyh.bmp"
             Black "../images/Cyvasse/bheavyh.bmp")
      (moves
         (step nw) (step ne) (step sw) (step se) (step w) (step e)
      )
   )
   (piece
      (name Elephant)
      (image White "../images/Cyvasse/weleph.bmp"
             Black "../images/Cyvasse/beleph.bmp")
      (moves
         (step nw) (step ne) (step sw) (step se) (step w) (step e)
      )
   )
   (piece
      (name Crossbow)
      (image White "../images/Cyvasse/wcrossb.bmp"
             Black "../images/Cyvasse/bcrossb.bmp")
      (moves
         (step nw) (step ne) (step sw) (step se) (step w) (step e)
      )
   )
   (piece
      (name Trebuchet)
      (image White "../images/Cyvasse/wtrebuch.bmp"
             Black "../images/Cyvasse/btrebuch.bmp")
      (moves
         (step nw) (step ne) (step sw) (step se) (step w) (step e)
      )
   )
   (piece
      (name Dragon)
      (image White "../images/Cyvasse/wdragon.bmp"
             Black "../images/Cyvasse/bdragon.bmp")
      (moves
         (step nw) (step ne) (step sw) (step se) (step w) (step e)
      )
   )
   (piece
      (name Tower)
      (image White "../images/Cyvasse/wtower.bmp"
             Black "../images/Cyvasse/btower.bmp")
      (moves
         (step nw) (step ne) (step sw) (step se) (step w) (step e)
      )
   )

   (board-setup
      (White
         (King l9)
      )
      (Black
         (King a1)
      )
   )
)

(variant
   (title "-")
)

(variant
   (title "Lesson 1")
   (description "3 moves")
   (default)

   (turn-order White)

   (piece
      (name Point)
      (image White "../images/Cyvasse/point.bmp"
             Black "../images/Cyvasse/point.bmp")
   )

   (board-setup
      (White
         (Rabble f6)
      )
      (Black
         (Point g4)
      )
   )
)

(variant
   (title "Lesson 2")
   (description "4 moves")

   (turn-order White)

   (piece
      (name Point)
      (image White "../images/Cyvasse/point.bmp"
             Black "../images/Cyvasse/point.bmp")
   )

   (board-setup
      (White
         (LightHorse f7)
         (Tower f2 i4 i6 k7)
         (Mount g6 d7 h7 j7 l7 f9 h9 j9 l9)
      )
      (Black
         (Tower h2 g4 k5)
         (Mount b1 d1 f1 h1 b3 d3 f3 h3 b5 d5 f5 h5 j5 l5)
         (Point j3)
      )
   )
)

(variant
   (title "Lesson 3")
   (description "8 moves")

   (turn-order White)

   (board-setup
      (White
         (Dragon g5)
      )
      (Black
         (Crossbow h2 e2 h4 f8 f6 i8)
      )
   )
)

(variant
   (title "Lesson 4")
   (description "4 moves")

   (turn-order White)

   (board-setup
      (White
         (LightHorse e6)
      )
      (Black
         (Rabble f6 i6 h5 e3)
      )
   )
)

(variant
   (title "Lesson 5")
   (description "4 moves")

   (turn-order White)

   (board-setup
      (White
         (LightHorse e6)
         (Crossbow i6)
      )
      (Black
         (Rabble h6 h4 e4)
      )
   )
)

(variant
   (title "Lesson 6")
   (description "3 moves")

   (turn-order White)

   (board
      (common-board lesson-6)
      (zone (name water) (players White Black)
            (positions e3 f3 e4 f4 e5)
      )
   )

   (board-setup
      (White
         (LightHorse h6)
         (Crossbow e6 h4)
      )
      (Black
         (Tower g5 e3)
      )
   )
)

(variant
   (title "Lesson 7")
   (description "5 moves")

   (turn-order White)

   (board
      (common-board lesson-7)
      (zone (name water) (players White Black)
            (positions e6)
      )
   )

   (board-setup
      (White
         (Rabble f7)
         (Crossbow f3 h6)
      )
      (Black
         (Tower e6 f6 e5 f5)
         (Mount e4 f4)
      )
   )
)

(variant
   (title "Lesson 8")
   (description "6 moves")

   (turn-order White)

   (board-setup
      (White
         (Spears h4 g6)
         (LightHorse f5)
         (Crossbow d6)
      )
      (Black
         (Spears d3 f3 g3 h5)
      )
   )
)

(variant
   (title "Lesson 9")
   (description "7 moves")

   (turn-order White)

   (board
      (common-board lesson-9)
      (zone (name water) (players White Black)
            (positions g5)
      )
   )

   (board-setup
      (White
         (LightHorse e7)
         (Elephant h7)
         (Trebuchet h6)
         (Tower g7)
         (King g6)
      )
      (Black
         (Rabble e5 f5 h5)
         (Spears e3 f3)
         (Tower d3 g3)
         (King e2)
         (Mount d1 e1)
      )
   )
)
